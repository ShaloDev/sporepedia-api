<%= render "shared/header"%>
<%= form_tag(creatures_path, method: 'get') do %>
  <%= label_tag :search_type, 'Search Type' %>
  <%= select_tag :search_type, options_for_select([
      ['Top Rated', 'TOP_RATED'],
      ['Top Rated New', 'TOP_RATED_NEW'],
      ['Newest', 'NEWEST'],
      ['Featured', 'FEATURED'],
      ['Maxis Made', 'MAXIS_MADE'],
      ['Random', 'RANDOM'],
      ['Cute and Creepy', 'CUTE_AND_CREEPY']
    ])
  %><br>

  <%= hidden_field_tag :page, params[:page] || 1 %>
  <%= hidden_field_tag :per_page, params[:per_page] || 10 %>

  <%= submit_tag 'Search' %>

  <% if @assets.any? %>
  <% @assets.each do |asset| %>
  <% end %>

  <%= link_to 'Previous Page', creatures_path(page: params[:page].to_i - 1,
    search_type: params[:search_type], per_page: params[:per_page]),
    method: 'get' if params[:page].to_i > 1 %>
  <%= link_to 'Next Page', creatures_path(page: params[:page].to_i + 1,
    search_type: params[:search_type], per_page: params[:per_page]), method: 'get' %>
  <% else %>
    <p>No creatures found.</p>
  <% end %>
<% end %>

<% @assets.each do |asset_data| %>
    <img src="<%= asset_data[:image] %>" alt="Asset Image">
    ID: <%= asset_data[:id] %><br>
    Name: <%= asset_data[:name] %><br>
    Author: <%= asset_data[:author] %><br>
    Created: <%= asset_data[:created] %><br>
    <% if asset_data[:description]!='NULL' %>
        Description: <%= asset_data[:description] %><br>   
    <% end %> 
    <%= link_to 'Download', download_creature_path(id: asset_data[:id]) %>
    <%= link_to 'See stats', creature_path(id: asset_data[:id]) %>   

    <%= form_with(model: @creature, url: creatures_path, method: :post) do |form| %>
      <%= form.hidden_field :creature_id, value: asset_data[:id] %>
      <%= form.hidden_field :image, value: asset_data[:image] %>
      <%= form.hidden_field :name, value: asset_data[:name] %>
      <%= form.hidden_field :author, value: asset_data[:author] %>
      <%= form.hidden_field :created, value: asset_data[:created] %>
      <%= form.hidden_field :description, value: asset_data[:description] %>
  
      <%= form.submit 'Add creature to collection' %>
    <% end %> 
    <br>
<% end %>
